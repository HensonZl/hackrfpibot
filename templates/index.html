{% extends "bootstrap/base.html" %}{% block title %}PiRFScannerBot{% endblock %}{% block content %}<link rel="stylesheet" href="../static/style.css/"><script src="{{url_for('static', filename='plotly-latest.min.js')}}"></script><script src="/static/bootstrap/jquery.min.js?bootstrap=3.3.7.1.dev1"></script><script src="/static/bootstrap/js/bootstrap.min.js?bootstrap=3.3.7.1.dev1"></script><script src="{{url_for('static', filename='highcharts.js')}}"></script><script src="{{url_for('static', filename='heatmap.js')}}"></script><script src="{{url_for('static', filename='boost.js')}}"></script><script src="{{url_for('static', filename='jquery-3.1.1.min.js')}}"></script><link rel='stylesheet' href="{{ url_for('static', filename='fa/css/fontawesome.min.css')}}"><link rel='stylesheet' href="{{ url_for('static', filename='fa/css/all.css')}}"><div class="jumbotron"><div class="panel panel-default">  <div class="panel-heading">    <h3 class="panel-title">Video Feed</h3>  </div>  <div class="panel-body">    <h3><img id="vidid" src="{{ url_for('video_feed') }}" width="100%"></h3>  </div></div><div class="panel panel-default">  <div class="panel-heading">    <h3 class="panel-title">Robot Controls</h3>  </div>  <div class="panel-body">    <div class="text-center">        <button type="button" class="btn btn-success" onclick="startForward();"><i class="fas fa-arrow-circle-up"></i></button>    </div>        <div class="text-center">        <button type="button" class="btn btn-success" onclick="startLeft();"><i class="fas fa-arrow-circle-left"></i></button>        <button type="button" class="btn btn-danger" onclick="startOff();"><i class="fas fa-stop-circle"></i></button>        <button type="button" class="btn btn-success" onclick="startRight();"><i class="fas fa-arrow-circle-right"></i></i></button>    </div>        <div class="text-center">        <button type="button" class="btn btn-success" onclick="startBackward();"><i class="fas fa-arrow-circle-down"></i></button>    </div>  </div></div><div id="chart"></div><div id="myDiv"></div><div id="container" style="height: 600px; min-width: 310px; max-width: 1000px; margin: 0 auto"></div><div class="panel panel-default">  <div class="panel-heading">    <h3 class="panel-title">Commands</h3>  </div>  <div class="panel-body">            <div class="text-center">         <button class="btn btn-default" onclick="startSDR();">Start SDR</button>         <button class="btn btn-default" onclick="startHeat();">Start Heat</button>         <button class="btn btn-default" onclick="startWater();">Start Water</button>      </div>            <div class="text-center">        <button class="btn btn-default" onclick="stopSDR();">Stop SDR</button>        <button class="btn btn-default" onclick="stopHeat();">Stop Heat</button>        <button class="btn btn-default" onclick="stopWater();">Stop Water</button>      </div>      <div class="text-center">        <lable>Select The RF Range To Scan: <lable>	<input type="text" id="rangeToScan" name="rangeToScan">      </div>      <div class="text-center">        <lable>Select The RF Range To Block: <lable>        <input type="text" id="rangeToBlock" name="rangeToBlock"><br>          <button class="btn btn-default" style="margin-top: 5px;" onclick="blockRF();">Block</button>      </div>        </div></div></div><script>$( document ).ready(function() {    $('#container').hide();});var cords;var tempStopVar;var tempStopVar2;var tempStopVar3;var setCount = 0;var lineGraphActive = true;var heatGraphActive = true;var waterGraphActive = true;var chart = Highcharts.chart('container', {            credits: {enabled: false},            chart: {                type: 'heatmap',                marginTop: 40,                marginBottom: 80,                plotBorderWidth: 1            },            boost: {                useGPUTranslations: true            },            plotOptions: {                series: {                    boostThreshold: 1000000,                    states: {                        hover: {                            enabled: false                        }                    }                }            },            title: {                text: 'Spectral Waterfall'            },            yAxis: {                title: '',                lineWidth: 0,                minorGridLineWidth: 0,                lineColor: 'transparent',                labels: {                    enabled: false                },                minorTickLength: 0,                tickLength: 0,                tickWidth: 0,                minPadding: 0,                maxPadding: 0,                startOnTick: false,                endOnTick: false,                minRange: 300            },            colorAxis: {                stops: [                    [0, '#3060cf'],                    [0.5, '#fffbbc'],                    [0.9, '#c4463a'],                    [1, '#c4463a']                ],                min: -120,                max: 0,                startOnTick: false,                endOnTick: false,                labels: {                    format: '{value}dB'                }            },            legend: {                align: 'right',                layout: 'vertical',                margin: 0,                verticalAlign: 'top',                y: 25,                symbolHeight: 280            },            tooltip: {                enabled: false            },            series: [{                name: 'Signal power',                borderWidth: 0,                data: []            }]});function startGraphing() { //this function gets the rf signal data from the webserver and displays it in a line graph from plotty.jsvar rfRange = document.getElementById("rangeToScan").value; //gets the intended range form the user "100:120" is the format that must be entered$.get("/gengraph/" + rfRange, function(data, status){cords = data;var trace1 = {x: cords[0],y: cords[1],type: 'scatter'};var data = [trace1];Plotly.newPlot('chart', data); //graghs the line grapg});}function startHeatmap(){ // this is a heatmap from plotty.js that uses Z-scores. This funtion uses the X and Y cords from the above function and calulates the z score and displays the graphvar total = 0;for(var i = 0; i < cords[1].length; i++) {    total += cords[1][i];}var avg = total / cords[1].length;var totalVar = 0.0;for(var i = 0; i < cords[1].length; i++) {    var tempVar = cords[1][i] - avg;    var tempVar2 = tempVar * tempVar;    totalVar += tempVar2}var variance = totalVar / (cords[1].length - 1);var stdDev = Math.sqrt(variance);var zScores = [];for(var i = 0; i < cords[1].length; i++) {    var tempVar3 = (cords[1][i] - avg) / stdDev;    zScores.push(tempVar3)}var xValues = cords[0];var yValues = cords[1];var zValues = zScores;var data = [{  x: xValues,  y: yValues,  z: zValues,  type: 'heatmap'}];Plotly.newPlot('myDiv', data); //plots the heat map}function createData() { //the init function for the spectural waterfall    var data = {freqData: cords[0], valueData: cords[1]};    processData(data);}function processData(data) { // draws the spectral waterfall based on the data recieved from the above funtions    for (var i = 0; i < data.freqData.length; i++) {        chart.series[0].addPoint([Math.round(data.freqData[i])/1000000, setCount, Math.round(data.valueData[i])], false, false, false);    }    chart.redraw();    setCount++;}function startWaterfall(){ //starts the spectural waterfall    createData();}function startSDR(){ //triggered by a button to start the line graphtempStopVar = setInterval(function(){ startGraphing(); }, 2000);}function stopSDR(){ //stops the line graphclearInterval(tempStopVar);}function startHeat(){ //triggered by a button to start the heapmaptempStopVar1 = setInterval(function(){ startHeatmap(); }, 2000);}function stopHeat(){ //stops the heatmapclearInterval(tempStopVar1);}function startWater(){ //triggered by a button to start the spectual waterfall$('#container').show();tempStopVar2 = setInterval(function(){ createData(); }, 2000);}function stopWater(){ //stops the spectural waterfallclearInterval(tempStopVar2);}function startForward(){ // the following five functions controls the robots movement$.get("/robot/forwards", function(data, status){});}function startBackward(){$.get("/robot/backwards", function(data, status){});}function startLeft(){$.get("/robot/left", function(data, status){});}function startRight(){$.get("/robot/right", function(data, status){});}function startOff(){$.get("/robot/off", function(data, status){});}function blockRF(){ //trigger by a button my the user to block a rf signal. WARRNING MUST BE USED IN A FARADAY CAGE AS THIS BREAKS FCC REGULATIONSvar rfBlock = document.getElementById("rangeToBlock").value;$.get("/block/" + rfBlock, function(data, status){});}</script>{% endblock %}